<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dynamic Size-Ratio-Shade Table</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-ENjdO4Dr2bkBIFxQpRAqDq2L8u0vnd6Q0XV5ZMDAh5PpvSs1Z8fPf16z/6M4PKF6" crossorigin="anonymous">
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
    <style>
        table {
            width: 100%;
            border-collapse: collapse;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }
        th {
            background-color: #f2f2f2;
        }
        form {
            margin-bottom: 20px;
        }
        .form-group {
            margin-bottom: 10px;
        }
    </style>
</head>
<body>
    <div class="container">
    <h1>Size-Ratio-Shade Table</h1>
    
    <form id="input-form">
        <div class="form-group">
            <label for="size-input">Size (e.g., S, M, L):</label>
            <input type="text" id="size-input" placeholder="Enter Sizes separated by commas" required>
        </div>
        <div class="form-group">
            <label for="ratio-input">Ratio (e.g., 2, 1, 2):</label>
            <input type="text" id="ratio-input" placeholder="Enter Ratios separated by commas" required>
        </div>
        <div class="form-group">
            <label for="shade-input">Shades (e.g., A,B,C):</label>
            <input type="text" id="shade-input" placeholder="Enter Shades separated by commas" required>
        </div>
        <button type="submit">Submit</button>
    </form>
    <div class="allTableBtn row">
        <button class="btn btn-primary col-4" id="downloadExcel">Excel</button>
        <button class="btn btn-primary col-4" id="downloadPDF">PDF</button>
      </div>
    <table id="data-table">
        <thead>
            <tr>
                <th>Size</th>
                <th>Ratio</th>
                <th>Shade</th>
                <th>Group</th>
            </tr>
        </thead>
        <tbody>
            <!-- Rows will be inserted here by JavaScript -->
        </tbody>
    </table>
</div>
    <script>
        function assignAlphabetToSizeRatio(data) {
    const sizeRatioMap = {};
    const alphabet = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
    let nextAlphabetIndex = 0;

    return data.map(row => {
        const key = `${row.size}-${row.ratio}`;
        if (!sizeRatioMap[key]) {
            sizeRatioMap[key] = alphabet[nextAlphabetIndex++];
            if (nextAlphabetIndex >= alphabet.length) {
                nextAlphabetIndex = 0; // Loop back if we run out of letters
            }
        }
        return {
            ...row,
            newColumn: sizeRatioMap[key]
        };
    });
}

function renderTable(data) {
    const tableBody = document.querySelector('#data-table tbody');
    tableBody.innerHTML = ''; // Clear any existing rows

    data.forEach(row => {
        const tr = document.createElement('tr');
        tr.innerHTML = `
            <td>${row.size}</td>
            <td>${row.ratio}</td>
            <td>${row.shade}</td>
            <td>${row.newColumn}</td>
        `;
        tableBody.appendChild(tr);
    });
}

document.getElementById('input-form').addEventListener('submit', function(event) {
    event.preventDefault(); // Prevent form submission

    // Get input values
    const sizeInput = document.getElementById('size-input').value;
    const ratioInput = document.getElementById('ratio-input').value;
    const shadeInput = document.getElementById('shade-input').value;

    // Split inputs into arrays
    const sizes = sizeInput.split(',').map(size => size.trim());
    const ratios = ratioInput.split(',').map(ratio => parseInt(ratio.trim(), 10));
    const shades = shadeInput.split(',').map(shade => shade.trim());

    // Ensure sizes, ratios and shades arrays have appropriate lengths
    if (sizes.length !== ratios.length) {
        alert('Sizes and Ratios must have the same number of entries.');
        return;
    }
    if (shades.length === 0) {
        alert('Shades must have at least one entry.');
        return;
    }

    // Parse input into data array with deviation and shade handling
    const data = sizes.flatMap((size, index) => {
        const ratio = ratios[index];
        // For each size-ratio combination, repeat for each shade
        return shades.flatMap(shade => 
            Array.from({ length: ratio }, (_, idx) => ({
                size,
                ratio: idx + 1,
                shade
            }))
        );
    });

    // Assign alphabets and render table
    const updatedData = assignAlphabetToSizeRatio(data);
    renderTable(updatedData);
});
document.getElementById('downloadExcel').addEventListener('click', function () {
    // Get the table element
    var wb = XLSX.utils.table_to_book(document.getElementById('data-table'), { sheet: "Sheet1" });
    
    // Convert the workbook to binary string
    var wbout = XLSX.write(wb, { bookType: 'xlsx', type: 'binary' });
    
    // Convert binary string to array buffer
    function s2ab(s) {
        var buf = new ArrayBuffer(s.length);
        var view = new Uint8Array(buf);
        for (var i = 0; i < s.length; i++) view[i] = s.charCodeAt(i) & 0xFF;
        return buf;
    }

    // Create a Blob from the array buffer
    var blob = new Blob([s2ab(wbout)], { type: "application/octet-stream" });
    
    // Create a link element to download the file
    var link = document.createElement('a');
    link.href = URL.createObjectURL(blob);
    link.download = 'group_Sheet.xlsx'; // Set the filename for the download
    link.click(); // Trigger the download
});
//Download PDF
document.getElementById("downloadPDF").addEventListener("click", function() {
  const { jsPDF } = window.jspdf;  // Get jsPDF from the library
  const doc = new jsPDF();
  
  doc.text("Group Summary", 14, 16);  // Add title or header to your PDF
  
  // Auto-table plugin to add the table into the PDF
  doc.autoTable({
      html: '#data-table',  // Target the table by ID
      startY: 20,  // Start position after the title
  });
  
  doc.save('group_summary.pdf');  // Save the PDF with the desired file name
});

    </script>
      <!-- Vendor JS Files -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.bundle.min.js" integrity="sha384-ppJv0u+jcKZi1TLua2tp0SmBbpIwr+1y4eEy5swNCTAMe/GE1oFkpT3DzoGbbc7+" crossorigin="anonymous"></script>
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
</body>
</html>
